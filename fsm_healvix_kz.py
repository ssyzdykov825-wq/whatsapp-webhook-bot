from aiogram import Router, F
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import StatesGroup, State
from aiogram.types import Message
from aiogram.filters import Command

router = Router()

class HealvixFSM(StatesGroup):
    greet = State()
    problem = State()
    warning = State()
    solution = State()
    offer = State()
    objections = State()
    order = State()

@router.message(Command("start"))
async def start_fsm(message: Message, state: FSMContext):
    await message.answer("–°”ô–ª–µ–º–µ—Ç—Å—ñ–∑ –±–µ! –ú–µ–Ω—ñ“£ –∞—Ç—ã–º ‚Äî –ê–π–¥–æ—Å, –º–µ–Ω Healvix –∫–æ–º–ø–∞–Ω–∏—è—Å—ã–Ω—ã“£ –º–∞–º–∞–Ω—ã–º—ã–Ω.\n"
                         "–°—ñ–∑ –∫”©–∑–≥–µ –∞—Ä–Ω–∞–ª“ì–∞–Ω —Ç–∞–±–∏“ì–∏ –∫–µ—à–µ–Ω –±–æ–π—ã–Ω—à–∞ ”©—Ç—ñ–Ω—ñ–º “õ–∞–ª–¥—ã—Ä“ì–∞–Ω –µ–¥—ñ“£—ñ–∑ ‚Äî 1-2 –º–∏–Ω—É—Ç —Å”©–π–ª–µ—Å—É–≥–µ —É–∞“õ—ã—Ç—ã“£—ã–∑ –±–∞—Ä –º–∞?")
    await state.set_state(HealvixFSM.problem)

@router.message(HealvixFSM.problem)
async def get_problem(message: Message, state: FSMContext):
    await state.update_data(problem=message.text)
    await message.answer("”®—Ç—ñ–Ω—ñ–º–¥—ñ ”©–∑—ñ“£—ñ–∑ “Ø—à—ñ–Ω “õ–∞–ª–¥—ã—Ä–¥—ã“£—ã–∑ –±–∞, ”ô–ª–¥–µ –∂–∞“õ—ã–Ω–¥–∞—Ä—ã“£—ã–∑“ì–∞ –º–∞?\n"
                         "“ö–∞–Ω–¥–∞–π –±–µ–ª–≥—ñ–ª–µ—Ä –º–∞–∑–∞–ª–∞–π–¥—ã ‚Äî –∫”©–∑–¥—ñ“£ —à–∞—Ä—à–∞—É—ã, –±“±–ª—ã“£“ì—ã—Ä –∫”©—Ä—É, –∫”©—Ä—É “õ–∞–±—ñ–ª–µ—Ç—ñ–Ω—ñ“£ —Ç”©–º–µ–Ω–¥–µ—É—ñ?")
    await state.set_state(HealvixFSM.warning)

@router.message(HealvixFSM.warning)
async def give_warning(message: Message, state: FSMContext):
    await state.update_data(symptoms=message.text)
    await message.answer("–ò”ô, “õ–∞–∑—ñ—Ä–≥—ñ –∑–∞–º–∞–Ω–¥–∞ –º“±–Ω–¥–∞–π –∂–∞“ì–¥–∞–π ”©—Ç–µ –∂–∏—ñ –∫–µ–∑–¥–µ—Å–µ–¥—ñ. –≠–∫—Ä–∞–Ω, —Å—Ç—Ä–µ—Å—Å, –∂–∞—Å –µ—Ä–µ–∫—à–µ–ª—ñ–∫—Ç–µ—Ä—ñ ‚Äî –±“±–ª–∞—Ä–¥—ã“£ –±”ô—Ä—ñ –∫”©–∑–≥–µ –∞—É—ã—Ä–ª—ã“õ —Ç“Ø—Å—ñ—Ä–µ–¥—ñ.\n\n"
                         "”®–∫—ñ–Ω—ñ—à–∫–µ “õ–∞—Ä–∞–π, –∫”©–ø –∞–¥–∞–º –∞–ª“ì–∞—à“õ—ã –±–µ–ª–≥—ñ–ª–µ—Ä–≥–µ –º”ô–Ω –±–µ—Ä–º–µ–π–¥—ñ. –ë—ñ—Ä–∞“õ —É–∞“õ—ã—Ç ”©—Ç–µ –∫–µ–ª–µ –∂–∞“ì–¥–∞–π —É—à—ã“ì–∞–¥—ã ‚Äî –∫”©–∑ “õ“±—Ä“ì–∞—É—ã, –∫”©—Ä—É–¥—ñ“£ –Ω–∞—à–∞—Ä–ª–∞—É—ã, –∫”©–∑—ñ–ª–¥—ñ—Ä—ñ–∫–∫–µ –¥–µ–π—ñ–Ω.\n"
                         "–ê–ª –∫”©–∑ ‚Äî –æ–ª –±“±–ª—à—ã“õ –µ–º–µ—Å, –±—ñ—Ä –∫–µ—Ç–∫–µ–Ω —Å–æ“£ “õ–∞–π—Ç–∞—Ä—É “õ–∏—ã–Ω.")
    await message.answer("–ö”©—Ä—É “õ–∞–±—ñ–ª–µ—Ç—ñ–Ω –∂–æ“ì–∞–ª—Ç—É ‚Äî –∂–∞–π “ì–∞–Ω–∞ —ã“£“ì–∞–π—Å—ã–∑–¥—ã“õ –µ–º–µ—Å. –ë“±–ª ‚Äî –∂–∞“õ—ã–Ω–¥–∞—Ä—ã“£—ã–∑–¥—ã –∞–Ω—ã“õ –∫”©—Ä–µ –∞–ª–º–∞—É.\n"
                         "–°—ñ–∑ –¥”ô–ª “õ–∞–∑—ñ—Ä –¥“±—Ä—ã—Å “õ–∞–¥–∞–º –∂–∞—Å–∞–¥—ã“£—ã–∑ ‚Äî –º”ô—Å–µ–ª–µ —É—à—ã“ì—ã–ø –∫–µ—Ç–ø–µ–π —Ç“±—Ä—ã–ø –∞–ª–¥—ã–Ω –∞–ª—É –µ“£ —Ç–∏—ñ–º–¥—ñ —à–µ—à—ñ–º.")
    await state.set_state(HealvixFSM.solution)

@router.message(HealvixFSM.solution)
async def give_solution(message: Message, state: FSMContext):
    await message.answer("Healvix ‚Äî –±“±–ª –∫”©–∑–¥—ñ —Ç–∞–±–∏“ì–∏ –∂–æ–ª–º–µ–Ω “õ–æ—Ä“ì–∞–π—Ç—ã–Ω –∂”ô–Ω–µ “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä–µ—Ç—ñ–Ω –∫–µ—à–µ–Ω.\n"
                         "“ö“±—Ä–∞–º—ã–Ω–¥–∞: –º–∏—è (—á–µ—Ä–Ω–∏–∫–∞), –ª—é—Ç–µ–∏–Ω, –í –¥”ô—Ä—É–º–µ–Ω–¥–µ—Ä—ñ –±–∞—Ä.\n"
                         "–ë“±–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—Ç–µ—Ä:\n"
                         "üîπ –∫”©–∑–¥—ñ“£ —ñ—à–∫—ñ —Ç—ñ–Ω–¥–µ—Ä—ñ–Ω “õ–æ—Ä–µ–∫—Ç–µ–Ω–¥—ñ—Ä–µ–¥—ñ\n"
                         "üîπ —à–∞—Ä—à–∞—É–¥—ã –±–∞—Å–∞–¥—ã\n"
                         "üîπ –∫”©—Ä—É–¥—ñ“£ –Ω–∞—à–∞—Ä–ª–∞—É—ã–Ω –±–∞—è—É–ª–∞—Ç–∞–¥—ã.")
    await message.answer("–ö–ª–∏–µ–Ω—Ç—Ç–µ—Ä–¥—ñ“£ –∞–π—Ç—É—ã–Ω—à–∞, 2 –∞–ø—Ç–∞ —ñ—à—ñ–Ω–¥–µ –∫”©—Ä—É “õ–∞–±—ñ–ª–µ—Ç—ñ–Ω—ñ“£ –∂–∞“õ—Å–∞—Ä“ì–∞–Ω—ã –±–∞–π“õ–∞–ª–∞–¥—ã.")
    await state.set_state(HealvixFSM.offer)

@router.message(HealvixFSM.offer)
async def make_offer(message: Message, state: FSMContext):
    await message.answer("“ö–∞–∑—ñ—Ä —Å—ñ–∑–¥—ñ“£ ”©—Ç—ñ–Ω—ñ–º—ñ“£—ñ–∑ –±–æ–π—ã–Ω—à–∞ –∞—Ä–Ω–∞–π—ã –∂–µ“£—ñ–ª–¥—ñ–∫ –±–∞—Ä.\n"
                         "–ñ–µ—Ç–∫—ñ–∑—É ‚Äî —Ç–µ–≥—ñ–Ω. –¢”©–ª–µ–º ‚Äî —Ç–µ–∫ –∞–ª“ì–∞–Ω –∫–µ–∑–¥–µ.\n"
                         "“ö–∞–ª–∞–π—Å—ã–∑: –±—ñ—Ä –∞–π–ª—ã“õ –∫—É—Ä—Å –ø–∞, ”ô–ª–¥–µ —Ç–æ–ª—ã“õ –Ω”ô—Ç–∏–∂–µ “Ø—à—ñ–Ω 2‚Äì3 –∞–π“ì–∞ –∞–ª–∞—Å—ã–∑ –±–∞?")
    await state.set_state(HealvixFSM.objections)

@router.message(HealvixFSM.objections)
async def handle_objections(message: Message, state: FSMContext):
    text = message.text.lower()

    if "–æ–π–ª–∞–Ω—É" in text:
        await message.answer("”ò—Ä–∏–Ω–µ, —Ç“Ø—Å—ñ–Ω–µ–º—ñ–Ω. –ë—ñ—Ä–∞“õ –∫”©—Ä—É ‚Äî –∫–µ–π—ñ–Ω–≥–µ “õ–∞–ª–¥—ã—Ä—É“ì–∞ –±–æ–ª–º–∞–π—Ç—ã–Ω –Ω”ô—Ä—Å–µ.\n"
                             "“ö–∞–∑—ñ—Ä –±—ñ—Ä “õ–∞–ø—Ç–∞–º–∞–º–µ–Ω –±–∞—Å—Ç–∞–ø, –∫”©–∑ –∂–µ—Ç–∫—ñ–∑—É–≥–µ –º“Ø–º–∫—ñ–Ω–¥—ñ–∫ –±–∞—Ä. –¢”ô—É–µ–∫–µ–ª –∂–æ“õ.")
    elif "–∂–∞–º–∞–Ω –µ–º–µ—Å" in text or "–æ–Ω—à–∞ –µ–º–µ—Å" in text:
        await message.answer("–î”ô–ª –æ—Å—ã–Ω–¥–∞–π –∫–µ–∑–µ“£ ‚Äî –∞–ª–¥—ã–Ω –∞–ª—É“ì–∞ —Ç–∞–ø—Ç—ã—Ä–º–∞—Å —É–∞“õ—ã—Ç.\n"
                             "–ö”©—Ä—É –Ω–∞—à–∞—Ä–ª–∞“ì–∞–Ω –∫–µ–∑–¥–µ “õ–∞–ª–ø—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É ”ô–ª–¥–µ“õ–∞–π–¥–∞ “õ–∏—ã–Ω ”ô—Ä—ñ “õ—ã–º–±–∞—Ç.")
    elif "—Å–µ–Ω–±–µ–π–º—ñ–Ω" in text or "–∫”©–º–µ–∫—Ç–µ—Å–ø–µ–π–¥—ñ" in text:
        await message.answer("–ë—ñ–∑ “ì–∞–∂–∞–π—ã–ø“õ–∞ —É”ô–¥–µ –±–µ—Ä–º–µ–π–º—ñ–∑. –ë—ñ—Ä–∞“õ –∫–ª–∏–µ–Ω—Ç—Ç–µ—Ä–¥—ñ“£ 80%-–¥–∞–Ω –∞—Å—Ç–∞–º—ã –æ“£ ”ô—Å–µ—Ä –±–∞–π“õ–∞“ì–∞–Ω.")
    else:
        await message.answer("–¢“Ø—Å—ñ–Ω–¥—ñ–º. –ë—ñ—Ä–∞“õ –∫”©—Ä—É ‚Äî –µ“£ “õ“±–Ω–¥—ã –¥“Ø–Ω–∏–µ–ª–µ—Ä–¥—ñ“£ –±—ñ—Ä—ñ. ”®–∑ –∫”©–∑—ñ“£—ñ–∑–≥–µ “õ–∞–º“õ–æ—Ä –±–æ–ª—ã“£—ã–∑.")

    await message.answer("–û–Ω–¥–∞ –∫–µ–ª—ñ—Å—Ç—ñ–∫, —Ç–∞–ø—Å—ã—Ä—ã—Å—Ç—ã —Ä”ô—Å—ñ–º–¥–µ–π—ñ–∫.\n"
                         "–ñ–µ—Ç–∫—ñ–∑—É –∫—É—Ä—å–µ—Ä–º–µ–Ω –Ω–µ–º–µ—Å–µ –ø–æ—à—Ç–∞ –∞—Ä“õ—ã–ª—ã –±–æ–ª–∞–¥—ã. –¢”©–ª–µ–º ‚Äî –∞–ª“ì–∞–Ω –∫–µ–∑–¥–µ.\n"
                         "–¢–µ–∫ —Ç–æ–ª—ã“õ –∞—Ç—ã-–∂”©–Ω—ñ“£—ñ–∑–¥—ñ, –º–µ–∫–µ–Ω–∂–∞–π –º–µ–Ω –Ω”©–º—ñ—Ä—ñ“£—ñ–∑–¥—ñ –∂–∞–∑—Å–∞“£—ã–∑ –±–æ–ª–¥—ã.")
    await state.set_state(HealvixFSM.order)

@router.message(HealvixFSM.order)
async def confirm_order(message: Message, state: FSMContext):
    await message.answer("–¢–∞–ø—Å—ã—Ä—ã—Å “õ–∞–±—ã–ª–¥–∞–Ω–¥—ã! –ñ–∞“õ—ã–Ω –∫“Ø–Ω–¥–µ—Ä—ñ —Å—ñ–∑–±–µ–Ω –±–∞–π–ª–∞–Ω—ã—Å–∞–º—ã–∑.\n"
                         "–ö”©—Ä—É “õ–∞–±—ñ–ª–µ—Ç—ñ“£—ñ–∑–≥–µ –±“Ø–≥—ñ–Ω–Ω–µ–Ω –±–∞—Å—Ç–∞–ø “õ–∞–º“õ–æ—Ä–ª—ã“õ –∂–∞—Å–∞“ì–∞–Ω—ã“£—ã–∑ ‚Äî ”©—Ç–µ –¥“±—Ä—ã—Å —à–µ—à—ñ–º!\n"
                         "–ö“Ø–Ω—ñ“£—ñ–∑ —Å”ô—Ç—Ç—ñ ”©—Ç—Å—ñ–Ω!")
    await state.clear()
